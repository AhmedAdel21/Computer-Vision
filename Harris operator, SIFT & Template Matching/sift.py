from re import T
import numpy as np
import cv2 as cv
import math
import matplotlib.pyplot as plt
from matplotlib.patches import ConnectionPatch



#get gradient of a point in image
def get_grad(img,x,y):
    '''
    params: 
        img: gray scale image
        x,y: coordinate of pixel
    return:
        magnitude and the angle of the gradient oriantation 
    '''
    dx=int(img[x+1,y])-int(img[x-1,y])
    dy=int(img[x,y+1])-int(img[x,y-1])
    magnitude=np.sqrt(np.power(dx,2)+np.power(dy,2))
    theta=np.degrees(np.arctan2([dy] ,[dx]))[0]
    if np.isnan(theta):
        theta=90
    if theta<0:
        theta+=360
    if theta >360:
        theta -= 360
    if theta == 360:
        theta-=1    
    return magnitude,int(theta)

def main_orientation(img,key_points):
    '''
    params:
        img: gray scale image
        key_points: list of oe key points each point is list [x,y]
    return:
        new_key_points : new key points each points is list [x,y,oriantations]
    '''

    #define bins number =36
    BINS_NUMBER=36
    BIN_WIDTH=int(360/BINS_NUMBER)

    # define kernal size around the key point
    KERNAL_SIZE=(16,16)
    HALF_KERNAL_SIZE=int(KERNAL_SIZE[0]/2)

    # define guassian kernal with mean and sigma 
    SIGMA=1
    MEAN=0
    guasian_kernal=np.random.normal(MEAN,SIGMA,KERNAL_SIZE)
    
    
    #intialize histogram and the new key points
    hist=[0]*BINS_NUMBER
    new_key_points=[]

    #loop over the key points
    for point in key_points:
        x=point[0]
        y=point[1]
    
    # take window around the point 16 * 16
        window=img[x-HALF_KERNAL_SIZE:x+HALF_KERNAL_SIZE,y-HALF_KERNAL_SIZE:y+HALF_KERNAL_SIZE]
    
    # for each point of the window compute its oriantation(magnitude and theta) 
        for i in range(-HALF_KERNAL_SIZE,HALF_KERNAL_SIZE):
            for j in range(-HALF_KERNAL_SIZE,HALF_KERNAL_SIZE):
                wx=x+i
                wy=y+j
                # get the gradient magnitude and theta 
                magnitude,theta=get_grad(img,wx,wy)
                
                # multiply the magnitude by the guassian kernal value
                magnitude=magnitude*guasian_kernal[i+HALF_KERNAL_SIZE,j+HALF_KERNAL_SIZE]
                
                # assign each point to a bin
                bin=int(theta/BIN_WIDTH)
                # add the magnitude of this pin to the histogram
                hist[bin]+=magnitude
        # the maximum oriantation is the max bin in histogram
        max_value=np.max(hist)
        max_bin=(np.argmax(hist)+1)*BIN_WIDTH
        new_key_points.append([x,y,max_bin])
        
        #uncomment this later
        #loop over the histogram if bin value >= .8 of the maximum value
        #add it to the key points
        # for bin_no in range(len(hist)):
        #     if bin_no==max_bin:continue
        #     if hist[bin_no]>=.8*max_value:
        #        new_key_points.append([x,y,bin_no*BIN_WIDTH]) 

    # return the new key point with its orientations
    return new_key_points

def local_descriptors(img,key_points):
    '''
    params:
        img: gray scale image
        key_points: list of oe key points each point is list [x,y,oriatation]
    return:
        new key points :add descriptors for each key with size =128
    '''
    new_key_points=[]
    # number of bins =8
    BINS_NUMBER=8

    # bin width = 360/8
    BIN_WIDTH=int(360/BINS_NUMBER)

    # kernal of size 16*16
    KERNAL_SIZE=(16,16)
    HALF_KERNAL_SIZE=int(KERNAL_SIZE[0]/2)
     # define guassian kernal with mean and sigma 
    SIGMA=1
    MEAN=0
    guasian_kernal=np.random.normal(MEAN,SIGMA,KERNAL_SIZE)
    #loop over eack key point 
    for point in key_points:
        x=point[0]
        y=point[1]
        oriantation=point[2]

        #take kernal around he point
        window=img[x-HALF_KERNAL_SIZE:x+HALF_KERNAL_SIZE,y-HALF_KERNAL_SIZE:y+HALF_KERNAL_SIZE]
        window_gradients=np.zeros(KERNAL_SIZE)
        window_thetas=np.zeros(KERNAL_SIZE)
        
        # for each point of the window compute its oriantation(magnitude and theta) 
        for i in range(-HALF_KERNAL_SIZE,HALF_KERNAL_SIZE):
            for j in range(-HALF_KERNAL_SIZE,HALF_KERNAL_SIZE):
                wx=x+i
                wy=y+j
                # get the gradient magnitude and theta 
                magnitude,theta=get_grad(img,wx,wy)
                
                # multiply the magnitude by the guassian kernal value
                magnitude=magnitude*guasian_kernal[i+HALF_KERNAL_SIZE,j+HALF_KERNAL_SIZE]

                #subtract key point oriatation from theta 
                theta =np.abs(theta - oriantation)
                window_gradients[i+HALF_KERNAL_SIZE,j+HALF_KERNAL_SIZE]=magnitude
                window_thetas[i+HALF_KERNAL_SIZE,j+HALF_KERNAL_SIZE]=theta

        # divide the window by 4 = 4 * 4
        window_sub_regions=[]
        window_sub_gradients=[]
        window_sub_thetas=[]
        for i in range(0,16,4):
            for j in range (0,16,4):
                window_sub_regions.append(window[i:i+4,j:j+4])
                window_sub_gradients.append(window_gradients[i:i+4,j:j+4]) 
                window_sub_thetas.append(window_thetas[i:i+4,j:j+4])
        
        #define the descriptor vector 
        descriptor=[]

        #loop over the window regions
        for region_idx in range(16):
            #define histogram for each region
            hist=[0]*BINS_NUMBER
            #loop over the region elements
            for i in range(4):
                for j in range(4):
                    theta_p=window_sub_thetas[region_idx][i,j]
                    magnitude_p=window_sub_gradients[region_idx][i,j]
                    if theta_p>=360:
                        theta_p -=360
                    bin=int(theta_p/BIN_WIDTH)
                    hist[bin]+=magnitude_p
            descriptor+=hist
        
        # normalize the descriptor vector hint can be replaced by vectorize version later
        descriptor_sum=sum(descriptor)
        if descriptor_sum>0:
            for d in range(128):
                descriptor[d] /= descriptor_sum
                # remove and descriptor above .2
                if descriptor[d]>.2:
                    descriptor[d]=.2
        
        # renormalize it
        descriptor_sum=sum(descriptor)
        if descriptor_sum>0:
            for d in range(128):
                descriptor[d] /= descriptor_sum
        
        new_key_points.append([x,y,oriantation,np.asarray(descriptor)])

    return new_key_points


filename = 'cat.jfif'

# gray = np.float32(gray)
# dst = cv.cornerHarris(gray,2,3,0.04)
# temp=np.zeros(gray.shape)
# #result is dilated for marking the corners, not important
# dst = cv.dilate(dst,None)
# # Threshold for an optimal value, it may vary depending on the image.
# img[dst>0.01*dst.max()]=[0,255,0]
# cv.imshow('dst',img)
# if cv.waitKey(0) & 0xff == 27:
#     cv.destroyAllWindows()

key_points=[(3, 64), (3, 65), (3, 66), (4, 64), (4, 65), (4, 66), (4, 67), (5, 64), (5, 65), (5, 66), (5, 67), (6, 64), (6, 65), (6, 66), (6, 67), (8, 59), (8, 60), (8, 61), (8, 62), (8, 63), (8, 64), (9, 59), (9, 60), (9, 61), (9, 62), (9, 63), (9, 64), (10, 59), (10, 60), (10, 61), (10, 62), (10, 63), (10, 64), (11, 59), (11, 60), (11, 61), (11, 62), (11, 63), (11, 64), (12, 59), (12, 60), (12, 61), (12, 62), (12, 63), (12, 64), (12, 65), (13, 59), (13, 60), (13, 61), (13, 62), (13, 63), (13, 64), (13, 65), (14, 59), (14, 60), (14, 61), (14, 62), (14, 63), (14, 64), (14, 65), (15, 60), (15, 61), (15, 62), (15, 63), (15, 64), (15, 65), (16, 60), (16, 61), (16, 62), (16, 63), (16, 64), (16, 65), (22, 57), (22, 58), (22, 59), (22, 60), (22, 61), (22, 62), (22, 214), (22, 215), (22, 216), (23, 57), (23, 58), (23, 59), (23, 60), (23, 61), (23, 62), (23, 214), (23, 215), (23, 216), (24, 57), (24, 58), (24, 59), (24, 60), (24, 61), (24, 62), (24, 63), (24, 214), (24, 215), (24, 216), (25, 60), (25, 61), (25, 62), (25, 63), (26, 60), (26, 61), (26, 62), (26, 63), (30, 57), (30, 58), (30, 59), (30, 60), (30, 61), (31, 57), (31, 58), (31, 59), (31, 60), (31, 61), (32, 57), (32, 58), (32, 59), (32, 60), (32, 61), (33, 57), (33, 58), (33, 59), (38, 99), (38, 100), (38, 101), (39, 99), (39, 100), (39, 101), (39, 102), (40, 99), (40, 100), (40, 101), (40, 102), (41, 100), (41, 101), (41, 102), (41, 107), (41, 108), (41, 109), (41, 110), (42, 107), (42, 108), (42, 109), (42, 110), (43, 107), (43, 108), (43, 109), (43, 110), (44, 107), (44, 108), (44, 109), (44, 110), (49, 110), (49, 111), (49, 112), (49, 113), (50, 101), (50, 102), (50, 103), (50, 110), (50, 111), (50, 112), (50, 113), (50, 114), (51, 101), (51, 102), (51, 103), (51, 104), (51, 110), (51, 111), (51, 112), (51, 113), (51, 114), (51, 164), (51, 165), (51, 166), (52, 101), (52, 102), (52, 103), (52, 104), (52, 107), (52, 108), (52, 109), (52, 110), (52, 111), (52, 112), (52, 113), (52, 114), (52, 162), (52, 163), (52, 164), (52, 165), (52, 166), (53, 101), (53, 102), (53, 103), (53, 104), (53, 107), (53, 108), (53, 109), (53, 110), (53, 111), (53, 112), (53, 113), (53, 114), (53, 162), (53, 163), (53, 164), (53, 165), (53, 166), (54, 102), (54, 103), (54, 104), (54, 107), (54, 108), (54, 109), (54, 110), (54, 111), (54, 112), (54, 113), (54, 114), (54, 115), (54, 117), (54, 118), (54, 119), (54, 162), (54, 163), (54, 164), (54, 165), (54, 166), (55, 107), (55, 108), (55, 109), (55, 110), (55, 111), (55, 112), (55, 113), (55, 114), (55, 115), (55, 117), (55, 118), (55, 119), (55, 162), (55, 163), (55, 164), (55, 165), (56, 107), (56, 108), (56, 109), (56, 110), (56, 111), (56, 112), (56, 113), (56, 114), (56, 115), (56, 117), (56, 118), (56, 119), (57, 108), (57, 109), (57, 110), (57, 111), (57, 112), (57, 113), (57, 114), (57, 115), (57, 117), (57, 118), (57, 119), (58, 105), (58, 106), (58, 107), (58, 108), (58, 109), (58, 110), (58, 111), (58, 112), (58, 113), (58, 114), (58, 115), (59, 105), (59, 106), (59, 107), (59, 108), (59, 109), (59, 110), (59, 111), (59, 112), (59, 113), (59, 114), (59, 115), (60, 105), (60, 106), (60, 107), (60, 108), (60, 109), (60, 110), (60, 111), (60, 112), (60, 113), (60, 114), (60, 115), (60, 154), (60, 155), (60, 156), (60, 157), (60, 158), (61, 105), (61, 106), (61, 107), (61, 108), (61, 109), (61, 110), (61, 111), (61, 112), (61, 113), (61, 114), (61, 154), (61, 155), (61, 156), (61, 157), (61, 158), (62, 105), (62, 106), (62, 107), (62, 108), (62, 109), (62, 110), (62, 111), (62, 112), (62, 113), (62, 114), (62, 115), (62, 153), (62, 154), (62, 155), (62, 156), (62, 157), (62, 158), (63, 106), (63, 107), (63, 108), (63, 109), (63, 110), (63, 111), (63, 112), (63, 113), (63, 114), (63, 115), (63, 153), (63, 154), (63, 155), (63, 156), (63, 157), (63, 158), (64, 107), (64, 108), (64, 109), (64, 110), (64, 111), (64, 112), (64, 113), (64, 114), (64, 115), (64, 153), (64, 154), (64, 155), (64, 156), (64, 157), (64, 158), (64, 159), (64, 160), (65, 108), (65, 109), (65, 110), (65, 111), (65, 112), (65, 113), (65, 114), (65, 153), (65, 154), (65, 155), (65, 156), (65, 157), (65, 158), (65, 159), (65, 160), (66, 109), (66, 110), (66, 111), (66, 112), (66, 117), (66, 118), (66, 119), (66, 156), (66, 157), (66, 158), (66, 159), (66, 160), (67, 117), (67, 118), (67, 119), (67, 120), (67, 156), (67, 157), (67, 158), (67, 159), (67, 160), (68, 92), (68, 93), (68, 94), (68, 117), (68, 118), (68, 119), (68, 120), (68, 156), (68, 157), (68, 158), (68, 159), (69, 92), (69, 93), (69, 94), (69, 95), (69, 117), (69, 118), (69, 119), (69, 120), (69, 156), (69, 157), (69, 158), (70, 92), (70, 93), (70, 94), (70, 95), (70, 117), (70, 118), (70, 119), (71, 93), (71, 94), (71, 95), (74, 147), (74, 148), (74, 149), (74, 150), (75, 147), (75, 148), (75, 149), (75, 150), (76, 122), (76, 123), (76, 124), (76, 147), (76, 148), (76, 149), (76, 150), (77, 122), (77, 123), (77, 124), (77, 125), (77, 147), (77, 148), (77, 149), (77, 150), (78, 114), (78, 115), (78, 116), (78, 117), (78, 118), (78, 119), (78, 122), (78, 123), (78, 124), (78, 125), (79, 114), (79, 115), (79, 116), (79, 117), (79, 118), (79, 119), (79, 122), (79, 123), (79, 124), (79, 125), (80, 114), (80, 115), (80, 116), (80, 117), (80, 118), (80, 119), (81, 114), (81, 115), (81, 116), (81, 117), (81, 118), (81, 119), (82, 200), (82, 201), (82, 202), (82, 203), (83, 199), (83, 200), (83, 201), (83, 202), (83, 203), (84, 108), (84, 109), (84, 110), (84, 111), (84, 112), (84, 115), (84, 116), (84, 117), (84, 199), (84, 200), (84, 201), (84, 202), (84, 203), (85, 108), (85, 109), (85, 110), (85, 111), (85, 112), (85, 114), (85, 115), (85, 116), (85, 117), (85, 199), (85, 200), (85, 201), (85, 202), (85, 203), (86, 108), (86, 109), (86, 110), (86, 111), (86, 112), (86, 114), (86, 115), (86, 116), (86, 117), (86, 155), (86, 156), (86, 157), (87, 99), (87, 100), (87, 101), (87, 108), (87, 109), (87, 110), (87, 111), (87, 112), (87, 114), (87, 115), (87, 116), (87, 117), (87, 118), (87, 139), (87, 140), (87, 141), (87, 142), (87, 154), (87, 155), (87, 156), (87, 157), (88, 98), (88, 99), (88, 100), (88, 101), (88, 102), (88, 108), (88, 109), (88, 110), (88, 111), (88, 112), (88, 115), (88, 116), (88, 117), (88, 118), (88, 119), (88, 138), (88, 139), (88, 140), (88, 141), (88, 142), (88, 154), (88, 155), (88, 156), (88, 157), (89, 98), (89, 99), (89, 100), (89, 101), (89, 102), (89, 103), (89, 104), (89, 108), (89, 109), (89, 110), (89, 111), (89, 112), (89, 115), (89, 116), (89, 117), (89, 118), (89, 119), (89, 138), (89, 139), (89, 140), (89, 141), (89, 142), (89, 143), (89, 154), (89, 155), (89, 156), (90, 98), (90, 99), (90, 100), (90, 101), (90, 102), (90, 103), (90, 104), (90, 105), (90, 106), (90, 109), (90, 110), (90, 111), (90, 115), (90, 116), (90, 117), (90, 118), (90, 119), (90, 138), (90, 139), (90, 140), (90, 141), (90, 142), (90, 143), (90, 144), (91, 98), (91, 99), (91, 100), (91, 101), (91, 102), (91, 103), (91, 104), (91, 105), (91, 106), (91, 107), (91, 116), (91, 117), (91, 118), (91, 119), (91, 138), (91, 139), (91, 140), (91, 141), (91, 142), (91, 143), (91, 144), (92, 99), (92, 100), (92, 101), (92, 102), (92, 103), (92, 104), (92, 105), (92, 106), (92, 107), (92, 116), (92, 117), (92, 118), (92, 119), (92, 138), (92, 139), (92, 140), (92, 141), (92, 142), (92, 143), (92, 144), (93, 87), (93, 88), (93, 89), (93, 90), (93, 91), (93, 99), (93, 100), (93, 101), (93, 102), (93, 103), (93, 104), (93, 105), (93, 106), (93, 107), (93, 117), (93, 118), (93, 119), (93, 138), (93, 139), (93, 140), (93, 141), (93, 142), (94, 87), (94, 88), (94, 89), (94, 90), (94, 91), (94, 100), (94, 101), (94, 102), (94, 103), (94, 104), (94, 105), (94, 106), (94, 107), (94, 117), (94, 118), (94, 119), (94, 139), (94, 140), (94, 141), (95, 87), (95, 88), (95, 89), (95, 90), (95, 91), (95, 103), (95, 104), (95, 105), (95, 106), (95, 107), (95, 117), (95, 118), (95, 119), (95, 132), (95, 133), (95, 134), (95, 135), (95, 136), (95, 142), (95, 143), (95, 144), (95, 145), (96, 87), (96, 88), (96, 89), (96, 90), (96, 91), (96, 104), (96, 105), (96, 106), (96, 116), (96, 117), (96, 118), (96, 119), (96, 131), (96, 132), (96, 133), (96, 134), (96, 135), (96, 136), (96, 137), (96, 142), (96, 143), (96, 144), (96, 145), (96, 146), (97, 88), (97, 89), (97, 90), (97, 116), (97, 117), (97, 118), (97, 119), (97, 127), (97, 128), (97, 129), (97, 131), (97, 132), (97, 133), (97, 134), (97, 135), (97, 136), (97, 137), (97, 141), (97, 142), (97, 143), (97, 144), (97, 145), (97, 146), (97, 147), (98, 102), (98, 103), (98, 104), (98, 105), (98, 113), (98, 114), (98, 115), (98, 116), (98, 117), (98, 118), (98, 119), (98, 127), (98, 128), (98, 129), (98, 131), (98, 132), (98, 133), (98, 134), (98, 135), (98, 136), (98, 137), (98, 138), (98, 139), (98, 140), (98, 141), (98, 142), (98, 143), (98, 144), (98, 145), (98, 146), (98, 147), (99, 102), (99, 103), (99, 104), (99, 105), (99, 106), (99, 112), (99, 113), (99, 114), (99, 115), (99, 116), (99, 117), (99, 118), (99, 119), (99, 125), (99, 126), (99, 127), (99, 128), (99, 129), (99, 131), (99, 132), (99, 133), (99, 134), (99, 135), (99, 136), (99, 137), (99, 138), (99, 139), (99, 140), (99, 141), (99, 142), (99, 143), (99, 144), (99, 145), (99, 146), (99, 147), (100, 100), (100, 101), (100, 102), (100, 103), (100, 104), (100, 105), (100, 106), (100, 111), (100, 112), (100, 113), (100, 114), (100, 115), (100, 116), (100, 117), (100, 118), (100, 119), (100, 125), (100, 126), (100, 127), (100, 128), (100, 129), (100, 130), (100, 131), (100, 132), (100, 133), (100, 134), (100, 137), (100, 138), (100, 139), (100, 140), (100, 141), (100, 142), (100, 143), (100, 144), (100, 145), (100, 146), (100, 147), (101, 100), (101, 101), (101, 102), (101, 103), (101, 104), (101, 105), (101, 106), (101, 107), (101, 108), (101, 110), (101, 111), (101, 112), (101, 113), (101, 114), (101, 115), (101, 116), (101, 117), (101, 118), (101, 125), (101, 126), (101, 127), (101, 128), (101, 129), (101, 130), (101, 131), (101, 132), (101, 141), (101, 142), (101, 143), (101, 144), (101, 145), (101, 146), (101, 147), (101, 148), (101, 149), (102, 99), (102, 100), (102, 101), (102, 102), (102, 103), (102, 104), (102, 105), (102, 106), (102, 107), (102, 108), (102, 110), (102, 111), (102, 112), (102, 113), (102, 114), (102, 115), (102, 116), (102, 117), (102, 125), (102, 126), (102, 127), (102, 128), (102, 129), (102, 130), (102, 131), (102, 132), (102, 143), (102, 144), (102, 145), (102, 146), (102, 147), (102, 148), (102, 149), (103, 94), (103, 95), (103, 96), (103, 97), (103, 98), (103, 99), (103, 100), (103, 101), (103, 102), (103, 103), (103, 104), (103, 105), (103, 106), (103, 107), (103, 108), (103, 110), (103, 111), (103, 112), (103, 113), (103, 114), (103, 115), (103, 116), (103, 117), (103, 130), (103, 131), (103, 132), (103, 143), (103, 144), (103, 145), (103, 146), (103, 147), (103, 148), (103, 149), (104, 72), (104, 73), (104, 74), (104, 75), (104, 76), (104, 77), (104, 94), (104, 95), (104, 96), (104, 97), (104, 98), (104, 99), (104, 100), (104, 101), (104, 102), (104, 103), (104, 104), (104, 105), (104, 106), (104, 107), (104, 108), (104, 110), (104, 111), (104, 112), (104, 113), (104, 114), (104, 115), (104, 116), (104, 117), (104, 143), (104, 144), (104, 145), (104, 146), (104, 147), (104, 148), (104, 149), (105, 72), (105, 73), (105, 74), (105, 75), (105, 76), (105, 77), (105, 78), (105, 81), (105, 82), (105, 83), (105, 84), (105, 94), (105, 95), (105, 96), (105, 97), (105, 98), (105, 99), (105, 100), (105, 101), (105, 119), (105, 120), (105, 121), (105, 144), (105, 145), (105, 146), (105, 147), (105, 148), (105, 149), (106, 70), (106, 71), (106, 72), (106, 73), (106, 74), (106, 75), (106, 76), (106, 77), (106, 78), (106, 79), (106, 80), (106, 81), (106, 82), (106, 83), (106, 84), (106, 85), (106, 86), (106, 95), (106, 96), (106, 97), (106, 98), (106, 99), (106, 100), (106, 101), (106, 119), (106, 120), (106, 121), (106, 143), (106, 144), (106, 145), (106, 146), (107, 69), (107, 70), (107, 71), (107, 72), (107, 73), (107, 74), (107, 75), (107, 76), (107, 77), (107, 78), (107, 79), (107, 80), (107, 81), (107, 82), (107, 83), (107, 84), (107, 85), (107, 86), (107, 98), (107, 99), (107, 100), (107, 101), (107, 119), (107, 120), (107, 121), (107, 143), (107, 144), (107, 145), (107, 146), (108, 69), (108, 70), (108, 71), (108, 72), (108, 73), (108, 74), (108, 77), (108, 78), (108, 79), (108, 80), (108, 81), (108, 82), (108, 83), (108, 84), (108, 85), (108, 86), (108, 91), (108, 92), (108, 93), (108, 98), (108, 99), (108, 100), (108, 101), (108, 102), (108, 141), (108, 142), (108, 143), (108, 144), (108, 145), (108, 146), (109, 69), (109, 70), (109, 71), (109, 72), (109, 73), (109, 74), (109, 77), (109, 78), (109, 79), (109, 80), (109, 81), (109, 82), (109, 83), (109, 84), (109, 85), (109, 86), (109, 91), (109, 92), (109, 93), (109, 98), (109, 99), (109, 100), (109, 101), (109, 102), (109, 139), (109, 140), (109, 141), (109, 142), (109, 143), (109, 144), (109, 145), (109, 146), (109, 147), (109, 148), (109, 149), (109, 150), (109, 151), (109, 152), (110, 69), (110, 70), (110, 71), (110, 72), (110, 73), (110, 77), (110, 78), (110, 79), (110, 80), (110, 81), (110, 82), (110, 83), (110, 84), (110, 85), (110, 91), (110, 92), (110, 93), (110, 100), (110, 101), (110, 102), (110, 139), (110, 140), (110, 141), (110, 142), (110, 143), (110, 144), (110, 145), (110, 146), (110, 147), (110, 148), (110, 149), (110, 150), (110, 151), (110, 152), (111, 69), (111, 70), (111, 71), (111, 72), (111, 77), (111, 78), (111, 79), (111, 80), (111, 81), (111, 82), (111, 83), (111, 84), (111, 91), (111, 92), (111, 93), (111, 139), (111, 140), (111, 141), (111, 142), (111, 143), (111, 144), (111, 145), (111, 146), (111, 147), (111, 148), (111, 149), (111, 150), (111, 151), (111, 152), (112, 77), (112, 78), (112, 79), (112, 80), (112, 81), (112, 82), (112, 83), (112, 140), (112, 141), (112, 142), (112, 143), (112, 144), (112, 145), (112, 146), (112, 147), (112, 148), (112, 149), (112, 150), (112, 151), (113, 77), (113, 78), (113, 79), (113, 80), (113, 81), (113, 82), (113, 83), (113, 87), (113, 88), (113, 89), (113, 90), (113, 142), (113, 143), (113, 144), (113, 145), (113, 146), (113, 147), (114, 77), (114, 78), (114, 79), (114, 80), (114, 81), (114, 87), (114, 88), (114, 89), (114, 90), (114, 142), (114, 143), (114, 144), (114, 145), (114, 146), (114, 147), (115, 78), (115, 79), (115, 80), (115, 86), (115, 87), (115, 88), (115, 89), (115, 90), (115, 142), (115, 143), (115, 144), (115, 145), (115, 146), (115, 167), (115, 168), (115, 169), (115, 170), (115, 171), (115, 172), (116, 86), (116, 87), (116, 88), (116, 89), (116, 90), (116, 99), (116, 100), (116, 101), (116, 142), (116, 143), (116, 144), (116, 161), (116, 162), (116, 163), (116, 164), (116, 165), (116, 166), (116, 167), (116, 168), (116, 169), (116, 170), (116, 171), (116, 172), (116, 173), (116, 174), (116, 175), (116, 176), (117, 86), (117, 87), (117, 88), (117, 89), (117, 90), (117, 99), (117, 100), (117, 101), (117, 102), (117, 161), (117, 162), (117, 163), (117, 164), (117, 165), (117, 166), (117, 167), (117, 168), (117, 169), (117, 170), (117, 171), (117, 172), (117, 173), (117, 174), (117, 175), (117, 176), (117, 177), (117, 178), (118, 87), (118, 88), (118, 89), (118, 90), (118, 99), (118, 100), (118, 101), (118, 102), (118, 161), (118, 162), (118, 163), (118, 164), (118, 165), (118, 166), (118, 167), (118, 168), (118, 169), (118, 170), (118, 171), (118, 172), (118, 173), (118, 174), (118, 175), (118, 176), (118, 177), (118, 178), (119, 99), (119, 100), (119, 101), (119, 102), (119, 161), (119, 162), (119, 163), (119, 164), (119, 165), (119, 166), (119, 167), (119, 168), (119, 169), (119, 170), (119, 171), (119, 172), (119, 173), (119, 174), (119, 175), (119, 176), (119, 177), (119, 178), (120, 99), (120, 100), (120, 101), (120, 162), (120, 163), (120, 164), (120, 165), (120, 167), (120, 168), (120, 169), (120, 170), (120, 173), (120, 174), (120, 175), (120, 176), (120, 177), (120, 178), (121, 99), (121, 100), (121, 101), (121, 156), (121, 157), (121, 158), (121, 159), (121, 174), (121, 175), (121, 176), (121, 177), (121, 178), (122, 99), (122, 100), (122, 101), (122, 156), (122, 157), (122, 158), (122, 159), (122, 160), (122, 174), (122, 175), (122, 176), (122, 177), (122, 178), (123, 156), (123, 157), (123, 158), (123, 159), (123, 160), (123, 175), (123, 176), (123, 177), (123, 178), (124, 99), (124, 100), (124, 101), (124, 156), (124, 157), (124, 158), (124, 159), (124, 160), (125, 99), (125, 100), (125, 101), (125, 102), (125, 156), (125, 157), (125, 158), (125, 159), (125, 160), (126, 99), (126, 100), (126, 101), (126, 102), (126, 156), (126, 157), (126, 158), (126, 159), (126, 160), (127, 95), (127, 96), (127, 97), (127, 99), (127, 100), (127, 101), (127, 102), (128, 92), (128, 93), (128, 94), (128, 95), (128, 96), (128, 97), (128, 98), (128, 99), (128, 100), (128, 101), (128, 102), (128, 140), (128, 141), (128, 142), (129, 89), (129, 90), (129, 91), (129, 92), (129, 93), (129, 94), (129, 95), (129, 96), (129, 97), (129, 98), (129, 139), (129, 140), (129, 141), (129, 142), (130, 88), (130, 89), (130, 90), (130, 91), (130, 92), (130, 93), (130, 94), (130, 95), (130, 96), (130, 97), (130, 98), (130, 138), (130, 139), (130, 140), (130, 141), (130, 142), (131, 88), (131, 89), (131, 90), (131, 91), (131, 92), (131, 93), (131, 94), (131, 95), (131, 96), (131, 97), (131, 98), (131, 99), (131, 100), (131, 137), (131, 138), (131, 139), (131, 140), (131, 141), (131, 142), (132, 88), (132, 89), (132, 90), (132, 91), (132, 92), (132, 93), (132, 94), (132, 95), (132, 98), (132, 99), (132, 100), (132, 136), (132, 137), (132, 138), (132, 139), (132, 140), (132, 141), (132, 142), (133, 94), (133, 95), (133, 96), (133, 97), (133, 98), (133, 99), (133, 100), (133, 135), (133, 136), (133, 137), (133, 138), (133, 139), (133, 140), (133, 141), (133, 142), (134, 91), (134, 92), (134, 93), (134, 94), (134, 95), (134, 96), (134, 97), (134, 135), (134, 136), (134, 137), (134, 138), (134, 139), (134, 140), (134, 141), (134, 142), (135, 89), (135, 90), (135, 91), (135, 92), (135, 93), (135, 94), (135, 95), (135, 96), (135, 97), (135, 135), (135, 136), (135, 137), (135, 138), (135, 139), (135, 140), (135, 141), (135, 142), (136, 89), (136, 90), (136, 91), (136, 92), (136, 93), (136, 94), (136, 95), (136, 96), (136, 135), (136, 136), (136, 137), (136, 138), (136, 139), (136, 185), (136, 186), (136, 187), (136, 188), (137, 89), (137, 90), (137, 91), (137, 92), (137, 93), (137, 94), (137, 95), (137, 96), (137, 185), (137, 186), (137, 187), (137, 188), (138, 89), (138, 90), (138, 91), (138, 92), (138, 93), (138, 94), (138, 95), (138, 96), (138, 185), (138, 186), (138, 187), (138, 188), (139, 92), (139, 93), (139, 94), (139, 95), (150, 98), (150, 99), (150, 100), (150, 101), (151, 97), (151, 98), (151, 99), (151, 100), (151, 101), (151, 102), (152, 97), (152, 98), (152, 99), (152, 100), (152, 101), (152, 102), (152, 103), (153, 97), (153, 98), (153, 99), (153, 100), (153, 101), (153, 102), (153, 103), (153, 125), (153, 126), (153, 127), (153, 128), (153, 129), (154, 97), (154, 98), (154, 99), (154, 100), (154, 101), (154, 102), (154, 103), (154, 125), (154, 126), (154, 127), (154, 128), (154, 129), (154, 130), (155, 98), (155, 99), (155, 100), (155, 101), (155, 102), (155, 103), (155, 125), (155, 126), (155, 127), (155, 128), (155, 129), (155, 130), (156, 99), (156, 100), (156, 101), (156, 102), (156, 103), (156, 104), (156, 107), (156, 108), (156, 109), (156, 124), (156, 125), (156, 126), (156, 127), (156, 128), (156, 129), (156, 130), (157, 99), (157, 100), (157, 101), (157, 102), (157, 103), (157, 104), (157, 105), (157, 106), (157, 107), (157, 108), (157, 109), (157, 110), (157, 122), (157, 123), (157, 124), (157, 125), (157, 126), (157, 127), (157, 128), (157, 129), (157, 130), (158, 100), (158, 101), (158, 102), (158, 103), (158, 104), (158, 105), (158, 106), (158, 107), (158, 108), (158, 109), (158, 110), (158, 115), (158, 116), (158, 117), (158, 118), (158, 119), (158, 121), (158, 122), (158, 123), (158, 124), (158, 125), (158, 126), (158, 127), (158, 128), (158, 129), (158, 130), (159, 102), (159, 103), (159, 104), (159, 105), (159, 106), (159, 107), (159, 108), (159, 109), (159, 110), (159, 111), (159, 112), (159, 113), (159, 115), (159, 116), (159, 117), (159, 118), (159, 119), (159, 120), (159, 121), (159, 122), (159, 123), (159, 124), (159, 125), (159, 126), (159, 127), (159, 128), (160, 104), (160, 105), (160, 106), (160, 107), (160, 108), (160, 109), (160, 110), (160, 111), (160, 112), (160, 113), (160, 115), (160, 116), (160, 117), (160, 118), (160, 119), (160, 120), (160, 121), (160, 122), (160, 123), (160, 124), (160, 125), (160, 126), (161, 104), (161, 105), (161, 106), (161, 107), (161, 108), (161, 109), (161, 110), (161, 111), (161, 112), (161, 113), (161, 114), (161, 115), (161, 116), (161, 117), (161, 118), (161, 119), (161, 120), (161, 121), (161, 122), (161, 123), (161, 124), (161, 125), (162, 104), (162, 105), (162, 106), (162, 107), (162, 108), (162, 109), (162, 110), (162, 111), (162, 112), (162, 113), (162, 114), (162, 115), (162, 116), (162, 117), (162, 118), (162, 119), (162, 120), (163, 104), (163, 105), (163, 106), (163, 107), (163, 108), (163, 109), (163, 110), (163, 111), (163, 112), (163, 113), (163, 114), (163, 115), (163, 116), (163, 117), (163, 118), (163, 119), (163, 120), (164, 106), (164, 107), (164, 108), (164, 109), (164, 110), (164, 111), (164, 112), (164, 113), (164, 114), (164, 115), (164, 116), (164, 117), (164, 118), (164, 119), (165, 107), (165, 108), (165, 109), (165, 110), (165, 111), (165, 113), (165, 114), (165, 115), (165, 116), (165, 117), (166, 113), (166, 114), (166, 115), (166, 116), (166, 117), (169, 161), (169, 162), (169, 163), (169, 164), (169, 165), (170, 159), (170, 160), (170, 161), (170, 162), (170, 163), (170, 164), (170, 165), (170, 166), (170, 167), (171, 159), (171, 160), (171, 161), (171, 162), (171, 163), (171, 164), (171, 165), (171, 166), (171, 167), (172, 158), (172, 159), (172, 160), (172, 161), (172, 162), (172, 163), (172, 164), (172, 165), (172, 166), (172, 167), (173, 158), (173, 159), (173, 160), (173, 161), (173, 162), (173, 163), (174, 158), (174, 159), (174, 160), (174, 161), (174, 162), (175, 158), (175, 159), (175, 160), (175, 161), (175, 162), (176, 155), (176, 156), (176, 157), (176, 158), (176, 159), (176, 160), (176, 161), (176, 162), (177, 155), (177, 156), (177, 157), (177, 158), (177, 159), (178, 155), (178, 156), (178, 157), (178, 158), (178, 159), (179, 156), (179, 157), (179, 158), (179, 159)]




key_points2 = [(19, 111), (19, 112), (19, 113), (19, 114), (20, 111), (20, 112), (20, 113), (20, 114), (21, 111), (21, 112), (21, 113), (21, 114), (22, 111), (22, 112), (22, 113), (22, 114), (26, 114), (26, 115), (26, 116), (26, 117), (27, 114), (27, 115), (27, 116), (27, 117), (28, 110), (28, 111), (28, 112), (28, 114), (28, 115), (28, 116), (28, 117), (29, 110), (29, 111), (29, 112), (29, 114), (29, 115), (29, 116), (29, 117), (30, 104), (30, 105), (30, 106), (30, 110), (30, 111), (30, 112), (30, 115), (30, 116), (30, 117), (31, 104), (31, 105), (31, 106), (31, 112), (31, 113), (31, 114), (32, 104), (32, 105), (32, 106), (32, 112), (32, 113), (32, 114), (33, 112), (33, 113), (33, 114), (34, 106), (34, 107), (34, 108), (34, 109), (34, 110), (34, 111), (34, 112), (34, 113), (34, 114), (35, 85), (35, 86), (35, 87), (35, 106), (35, 107), (35, 108), (35, 109), (35, 110), (35, 111), (35, 112), (35, 113), (35, 114), (35, 115), (36, 85), (36, 86), (36, 87), (36, 103), (36, 104), (36, 105), (36, 106), (36, 107), (36, 108), (36, 109), (36, 110), (36, 111), (36, 112), (36, 113), (36, 114), (36, 115), (37, 85), (37, 86), (37, 87), (37, 101), (37, 102), (37, 103), (37, 104), (37, 105), (37, 106), (37, 107), (37, 108), (37, 109), (37, 110), (37, 111), (37, 112), (37, 113), (37, 114), (37, 115), (38, 85), (38, 86), (38, 87), (38, 101), (38, 102), (38, 103), (38, 104), (38, 105), (38, 106), (38, 107), (38, 108), (38, 109), (38, 110), (38, 111), (38, 112), (38, 113), (38, 114), (39, 100), (39, 101), (39, 102), (39, 103), (39, 104), (39, 105), (39, 106), (39, 107), (39, 108), (39, 109), (39, 110), (39, 111), (39, 112), (39, 113), (39, 114), (40, 100), (40, 101), (40, 102), (40, 103), (40, 104), (40, 105), (40, 106), (40, 107), (40, 108), (40, 109), (40, 110), (40, 111), (40, 112), (41, 100), (41, 101), (41, 102), (41, 103), (41, 104), (41, 105), (41, 106), (41, 107), (41, 108), (41, 109), (41, 110), (41, 111), (41, 112), (42, 100), (42, 101), (42, 102), (42, 103), (42, 104), (42, 105), (42, 106), (42, 107), (42, 108), (42, 109), (42, 110), (42, 111), (42, 112), (42, 113), (42, 114), (42, 115), (43, 100), (43, 101), (43, 102), (43, 103), (43, 104), (43, 105), (43, 106), (43, 107), (43, 108), (43, 109), (43, 110), (43, 111), (43, 112), (43, 113), (43, 114), (43, 115), (44, 100), (44, 101), (44, 102), (44, 103), (44, 104), (44, 105), (44, 106), (44, 107), (44, 108), (44, 109), (44, 110), (44, 111), (44, 112), (44, 113), (44, 114), (44, 115), (45, 100), (45, 101), (45, 102), (45, 103), (45, 104), (45, 105), (45, 106), (45, 107), (45, 108), (45, 109), (45, 112), (45, 113), (45, 114), (45, 115), (46, 42), (46, 43), (46, 44), (46, 45), (46, 46), (46, 47), (46, 48), (46, 101), (46, 102), (46, 103), (46, 104), (46, 105), (46, 106), (46, 107), (46, 113), (46, 114), (46, 115), (47, 40), (47, 41), (47, 42), (47, 43), (47, 44), (47, 45), (47, 46), (47, 47), (47, 48), (47, 49), (47, 102), (47, 103), (47, 104), (47, 105), (47, 106), (48, 40), (48, 41), (48, 42), (48, 43), (48, 44), (48, 45), (48, 46), (48, 47), (48, 48), (48, 49), (48, 50), (49, 40), (49, 41), (49, 42), (49, 43), (49, 44), (49, 45), (49, 46), (49, 47), (49, 48), (49, 49), (49, 50), (49, 64), (49, 65), (49, 66), (49, 67), (50, 40), (50, 41), (50, 42), (50, 43), (50, 44), (50, 45), (50, 46), (50, 47), (50, 48), (50, 49), (50, 50), (50, 63), (50, 64), (50, 65), (50, 66), (50, 67), (51, 47), (51, 48), (51, 49), (51, 50), (51, 63), (51, 64), (51, 65), (51, 66), (51, 67), (51, 104), (51, 105), (51, 106), (52, 47), (52, 48), (52, 49), (52, 50), (52, 63), (52, 64), (52, 65), (52, 66), (52, 67), (52, 103), (52, 104), (52, 105), (52, 106), (53, 45), (53, 46), (53, 47), (53, 48), (53, 49), (53, 50), (53, 51), (53, 52), (53, 53), (53, 64), (53, 65), (53, 66), (53, 67), (53, 75), (53, 76), (53, 77), (53, 78), (53, 103), (53, 104), (53, 105), (53, 106), (54, 45), (54, 46), (54, 47), (54, 48), (54, 49), (54, 50), (54, 51), (54, 52), (54, 53), (54, 54), (54, 75), (54, 76), (54, 77), (54, 78), (54, 79), (54, 103), (54, 104), (54, 105), (54, 106), (55, 44), (55, 45), (55, 46), (55, 47), (55, 48), (55, 49), (55, 50), (55, 51), (55, 52), (55, 53), (55, 54), (55, 55), (55, 74), (55, 75), (55, 76), (55, 77), (55, 78), (55, 79), (55, 104), (55, 105), (55, 106), (56, 44), (56, 45), (56, 46), (56, 47), (56, 48), (56, 49), (56, 50), (56, 51), (56, 52), (56, 53), (56, 54), (56, 55), (56, 74), (56, 75), (56, 76), (56, 77), (56, 78), (56, 79), (57, 44), (57, 45), (57, 46), (57, 47), (57, 48), (57, 49), (57, 50), (57, 51), (57, 52), (57, 53), (57, 54), (57, 55), (57, 74), (57, 75), (57, 76), (57, 77), (57, 78), (57, 79), (58, 44), (58, 45), (58, 46), (58, 47), (58, 48), (58, 49), (58, 50), (58, 51), (58, 52), (58, 53), (58, 54), (58, 55), (58, 74), (58, 75), (58, 76), (58, 77), (58, 78), (58, 79), (58, 85), (58, 86), (58, 87), (58, 88), (58, 89), (58, 94), (58, 95), (58, 96), (59, 44), (59, 45), (59, 46), (59, 47), (59, 48), (59, 49), (59, 50), (59, 51), (59, 52), (59, 53), (59, 54), (59, 74), (59, 75), (59, 76), (59, 77), (59, 78), (59, 79), (59, 80), (59, 84), (59, 85), (59, 86), (59, 87), (59, 88), (59, 89), (59, 94), (59, 95), (59, 96), (59, 97), (59, 98), (59, 99), (60, 63), (60, 64), (60, 65), (60, 75), (60, 76), (60, 77), (60, 78), (60, 79), (60, 80), (60, 84), (60, 85), (60, 86), (60, 87), (60, 88), (60, 89), (60, 94), (60, 95), (60, 96), (60, 97), (60, 98), (60, 99), (61, 62), (61, 63), (61, 64), (61, 65), (61, 75), (61, 76), (61, 77), (61, 78), (61, 79), (61, 80), (61, 84), (61, 85), (61, 86), (61, 87), (61, 88), (61, 89), (61, 94), (61, 95), (61, 96), (61, 97), (61, 98), (61, 99), (62, 62), (62, 63), (62, 64), (62, 65), (62, 75), (62, 76), (62, 77), (62, 78), (62, 79), (62, 80), (62, 84), (62, 85), (62, 86), (62, 87), (62, 94), (62, 95), (62, 96), (62, 97), (62, 98), (62, 101), (62, 102), (62, 103), (63, 49), (63, 50), (63, 51), (63, 52), (63, 56), (63, 57), (63, 58), (63, 62), (63, 63), (63, 64), (63, 65), (63, 67), (63, 68), (63, 69), (63, 70), (63, 71), (63, 72), (63, 73), (63, 74), (63, 75), (63, 76), (63, 77), (63, 78), (63, 79), (63, 80), (63, 84), (63, 85), (63, 86), (63, 87), (63, 89), (63, 90), (63, 91), (63, 92), (63, 101), (63, 102), (63, 103), (64, 48), (64, 49), (64, 50), (64, 51), (64, 52), (64, 53), (64, 56), (64, 57), (64, 58), (64, 62), (64, 63), (64, 64), (64, 65), (64, 66), (64, 67), (64, 68), (64, 69), (64, 70), (64, 71), (64, 72), (64, 73), (64, 74), (64, 89), (64, 90), (64, 91), (64, 92), (64, 101), (64, 102), (64, 103), (65, 48), (65, 49), (65, 50), (65, 51), (65, 52), (65, 53), (65, 56), (65, 57), (65, 58), (65, 62), (65, 63), (65, 64), (65, 65), (65, 66), (65, 67), (65, 68), (65, 69), (65, 70), (65, 71), (65, 72), (65, 73), (65, 74), (65, 88), (65, 89), (65, 90), (65, 91), (65, 92), (65, 101), (65, 102), (65, 103), (66, 48), (66, 49), (66, 50), (66, 51), (66, 52), (66, 53), (66, 63), (66, 64), (66, 65), (66, 66), (66, 67), (66, 68), (66, 69), (66, 70), (66, 71), (66, 72), (66, 73), (66, 74), (66, 88), (66, 89), (66, 90), (66, 91), (67, 48), (67, 49), (67, 50), (67, 51), (67, 52), (67, 53), (67, 62), (67, 63), (67, 64), (67, 65), (67, 66), (67, 67), (67, 68), (67, 69), (67, 70), (67, 71), (67, 72), (67, 73), (67, 74), (67, 87), (67, 88), (67, 89), (67, 90), (67, 91), (68, 48), (68, 49), (68, 50), (68, 51), (68, 62), (68, 63), (68, 64), (68, 65), (68, 69), (68, 70), (68, 71), (68, 72), (68, 73), (68, 74), (68, 87), (68, 88), (68, 89), (68, 90), (68, 91), (69, 62), (69, 63), (69, 64), (69, 65), (69, 69), (69, 70), (69, 71), (69, 72), (69, 73), (69, 74), (69, 85), (69, 86), (69, 87), (69, 88), (69, 89), (69, 90), (69, 91), (70, 63), (70, 64), (70, 65), (70, 70), (70, 71), (70, 72), (70, 73), (70, 74), (70, 85), (70, 86), (70, 87), (70, 88), (70, 89), (70, 90), (70, 91), (71, 63), (71, 64), (71, 65), (71, 74), (71, 75), (71, 76), (71, 77), (71, 78), (71, 79), (71, 80), (71, 81), (71, 84), (71, 85), (71, 86), (71, 87), (72, 74), (72, 75), (72, 76), (72, 77), (72, 78), (72, 79), (72, 80), (72, 81), (72, 82), (72, 83), (72, 84), (72, 85), (72, 86), (73, 74), (73, 75), (73, 76), (73, 77), (73, 78), (73, 79), (73, 80), (73, 81), (73, 82), (73, 83), (73, 84), (73, 85), (73, 86), (73, 134), (73, 135), (73, 136), (73, 137), (74, 55), (74, 56), (74, 57), (74, 58), (74, 74), (74, 75), (74, 76), (74, 77), (74, 78), (74, 79), (74, 80), (74, 81), (74, 82), (74, 83), (74, 84), (74, 85), (74, 86), (74, 132), (74, 133), (74, 134), (74, 135), (74, 136), (74, 137), (74, 138), (75, 54), (75, 55), (75, 56), (75, 57), (75, 58), (75, 75), (75, 76), (75, 77), (75, 78), (75, 79), (75, 80), (75, 81), (75, 82), (75, 83), (75, 84), (75, 85), (75, 132), (75, 133), (75, 134), (75, 135), (75, 136), (75, 137), (75, 138), (76, 39), (76, 40), (76, 41), (76, 42), (76, 53), (76, 54), (76, 55), (76, 56), (76, 57), (76, 58), (76, 76), (76, 77), (76, 78), (76, 79), (76, 80), (76, 81), (76, 82), (76, 132), (76, 133), (76, 134), (76, 135), (76, 136), (76, 137), (76, 138), (77, 39), (77, 40), (77, 41), (77, 42), (77, 43), (77, 44), (77, 53), (77, 54), (77, 55), (77, 56), (77, 57), (77, 58), (77, 77), (77, 78), (77, 79), (77, 111), (77, 112), (77, 113), (77, 132), (77, 133), (77, 134), (77, 135), (77, 136), (77, 137), (77, 138), (78, 39), (78, 40), (78, 41), (78, 42), (78, 43), (78, 44), (78, 45), (78, 46), (78, 47), (78, 53), (78, 54), (78, 55), (78, 56), (78, 57), (78, 111), (78, 112), (78, 113), (78, 120), (78, 121), (78, 122), (78, 123), (78, 132), (78, 133), (78, 134), (78, 135), (78, 136), (78, 137), (79, 40), (79, 41), (79, 42), (79, 43), (79, 44), (79, 45), (79, 46), (79, 47), (79, 48), (79, 111), (79, 112), (79, 113), (79, 119), (79, 120), (79, 121), (79, 122), (79, 123), (79, 131), (79, 132), (79, 133), (79, 134), (79, 135), (79, 136), (79, 137), (80, 36), (80, 37), (80, 38), (80, 39), (80, 41), (80, 42), (80, 43), (80, 44), (80, 45), (80, 46), (80, 47), (80, 48), (80, 50), (80, 51), (80, 52), (80, 78), (80, 79), (80, 80), (80, 87), (80, 88), (80, 89), (80, 90), (80, 91), (80, 92), (80, 119), (80, 120), (80, 121), (80, 122), (80, 123), (80, 131), (80, 132), (80, 133), (80, 134), (80, 135), (80, 136), (80, 137), (81, 36), (81, 37), (81, 38), (81, 39), (81, 40), (81, 41), (81, 42), (81, 43), (81, 44), (81, 45), (81, 46), (81, 47), (81, 48), (81, 49), (81, 50), (81, 51), (81, 52), (81, 78), (81, 79), (81, 80), (81, 87), (81, 88), (81, 89), (81, 90), (81, 91), (81, 92), (81, 104), (81, 105), (81, 106), (81, 119), (81, 120), (81, 121), (81, 122), (81, 123), (81, 131), (81, 132), (81, 133), (81, 134), (81, 135), (81, 136), (81, 137), (82, 36), (82, 37), (82, 38), (82, 39), (82, 40), (82, 41), (82, 42), (82, 43), (82, 44), (82, 45), (82, 46), (82, 47), (82, 48), (82, 49), (82, 50), (82, 51), (82, 52), (82, 78), (82, 79), (82, 80), (82, 87), (82, 88), (82, 89), (82, 90), (82, 91), (82, 92), (82, 93), (82, 94), (82, 95), (82, 96), (82, 103), (82, 104), (82, 105), (82, 106), (82, 107), (82, 108), (83, 36), (83, 37), (83, 38), (83, 39), (83, 40), (83, 41), (83, 42), (83, 43), (83, 44), (83, 49), (83, 50), (83, 51), (83, 52), (83, 87), (83, 88), (83, 89), (83, 90), (83, 92), (83, 93), (83, 94), (83, 95), (83, 96), (83, 97), (83, 98), (83, 102), (83, 103), (83, 104), (83, 105), (83, 106), (83, 107), (83, 108), (84, 36), (84, 37), (84, 38), (84, 39), (84, 40), (84, 41), (84, 42), (84, 43), (84, 44), (84, 87), (84, 88), (84, 89), (84, 90), (84, 91), (84, 92), (84, 93), (84, 94), (84, 95), (84, 96), (84, 97), (84, 98), (84, 102), (84, 103), (84, 104), (84, 105), (84, 106), (84, 107), (84, 108), (85, 37), (85, 38), (85, 39), (85, 40), (85, 41), (85, 42), (85, 43), (85, 89), (85, 90), (85, 91), (85, 92), (85, 93), (85, 94), (85, 95), (85, 96), (85, 97), (85, 98), (85, 102), (85, 103), (85, 104), (85, 105), (85, 106), (85, 107), (86, 38), (86, 39), (86, 40), (86, 41), (86, 89), (86, 90), (86, 91), (86, 92), (86, 93), (86, 94), (86, 95), (86, 96), (86, 97), (86, 98), (86, 102), (86, 103), (86, 104), (86, 105), (86, 106), (86, 107), (86, 108), (87, 89), (87, 90), (87, 91), (87, 95), (87, 96), (87, 97), (87, 98), (87, 102), (87, 103), (87, 104), (87, 105), (87, 106), (87, 107), (87, 108), (88, 96), (88, 97), (88, 98), (88, 106), (88, 107), (88, 108), (89, 96), (89, 97), (89, 98), (90, 96), (90, 97), (90, 98), (90, 99), (90, 100), (90, 101), (90, 102), (90, 103), (90, 104), (91, 98), (91, 99), (91, 100), (91, 101), (91, 102), (91, 103), (91, 104), (92, 98), (92, 99), (92, 100), (92, 101), (92, 102), (92, 103), (92, 104), (92, 116), (92, 117), (92, 118), (92, 119), (93, 98), (93, 99), (93, 100), (93, 101), (93, 102), (93, 103), (93, 104), (93, 116), (93, 117), (93, 118), (93, 119), (94, 99), (94, 100), (94, 101), (94, 102), (94, 103), (94, 104), (94, 116), (94, 117), (94, 118), (94, 119), (95, 98), (95, 99), (95, 100), (95, 101), (95, 102), (95, 103), (95, 104), (96, 98), (96, 99), (96, 100), (96, 101), (97, 30), (97, 31), (97, 32), (97, 33), (97, 34), (97, 90), (97, 91), (97, 92), (97, 93), (97, 98), (97, 99), (97, 100), (97, 101), (97, 102), (97, 103), (98, 30), (98, 31), (98, 32), (98, 33), (98, 34), (98, 90), (98, 91), (98, 92), (98, 93), (98, 94), (98, 95), (98, 96), (98, 97), (98, 98), (98, 99), (98, 100), (98, 101), (98, 102), (98, 103), (99, 30), (99, 31), (99, 32), (99, 33), (99, 34), (99, 90), (99, 91), (99, 92), (99, 93), (99, 94), (99, 95), (99, 96), (99, 97), (99, 98), (99, 99), (99, 100), (99, 101), (99, 102), (99, 103), (100, 29), (100, 30), (100, 31), (100, 32), (100, 33), (100, 34), (100, 90), (100, 91), (100, 92), (100, 93), (100, 94), (100, 95), (100, 96), (100, 97), (100, 98), (100, 99), (100, 100), (100, 101), (100, 102), (101, 29), (101, 30), (101, 31), (101, 32), (101, 33), (101, 34), (101, 90), (101, 91), (101, 92), (101, 93), (101, 94), (101, 95), (101, 96), (101, 97), (101, 98), (102, 29), (102, 30), (102, 31), (102, 32), (102, 33), (102, 34), (102, 88), (102, 89), (102, 90), (102, 91), (102, 92), (102, 93), (102, 94), (102, 95), (102, 96), (102, 97), (103, 29), (103, 30), (103, 31), (103, 32), (103, 33), (103, 34), (103, 88), (103, 89), (103, 90), (103, 91), (103, 92), (103, 93), (103, 94), (103, 95), (103, 96), (103, 97), (103, 98), (104, 29), (104, 30), (104, 31), (104, 32), (104, 33), (104, 88), (104, 89), (104, 90), (104, 91), (104, 92), (104, 93), (104, 94), (104, 95), (104, 96), (104, 97), (104, 98), (104, 99), (104, 100), (105, 29), (105, 30), (105, 31), (105, 32), (105, 33), (105, 89), (105, 90), (105, 91), (105, 92), (105, 93), (105, 94), (105, 95), (105, 96), (105, 97), (105, 98), (105, 99), (105, 100), (106, 30), (106, 31), (106, 32), (106, 94), (106, 95), (106, 96), (106, 97), (106, 98), (106, 99), (106, 100), (106, 112), (106, 113), (106, 114), (107, 30), (107, 31), (107, 32), (107, 33), (107, 96), (107, 97), (107, 98), (107, 99), (107, 112), (107, 113), (107, 114), (108, 29), (108, 30), (108, 31), (108, 32), (108, 33), (108, 34), (108, 35), (108, 36), (108, 112), (108, 113), (108, 114), (109, 29), (109, 30), (109, 31), (109, 32), (109, 33), (109, 34), (109, 35), (109, 36), (109, 89), (109, 90), (109, 91), (110, 29), (110, 30), (110, 31), (110, 32), (110, 33), (110, 34), (110, 35), (110, 36), (110, 89), (110, 90), (110, 91), (111, 29), (111, 30), (111, 31), (111, 32), (111, 33), (111, 34), (111, 35), (111, 36), (111, 69), (111, 70), (111, 71), (111, 72), (111, 73), (111, 74), (111, 75), (111, 76), (111, 77), (111, 78), (111, 79), (111, 89), (111, 90), (111, 91), (112, 29), (112, 30), (112, 31), (112, 32), (112, 33), (112, 34), (112, 35), (112, 36), (112, 37), (112, 69), (112, 70), (112, 71), (112, 72), (112, 73), (112, 74), (112, 75), (112, 76), (112, 77), (112, 78), (112, 79), (113, 29), (113, 30), (113, 31), (113, 32), (113, 33), (113, 34), (113, 35), (113, 36), (113, 37), (113, 69), (113, 70), (113, 71), (113, 72), (113, 73), (113, 74), (113, 75), (113, 76), (113, 77), (113, 78), (113, 79), (114, 29), (114, 30), (114, 31), (114, 32), (114, 33), (114, 34), (114, 35), (114, 36), (114, 37), (114, 69), (114, 70), (114, 71), (114, 72), (114, 73), (114, 74), (114, 75), (114, 76), (114, 77), (114, 78), (115, 29), (115, 30), (115, 31), (115, 32), (115, 33), (115, 34), (115, 35), (115, 36), (115, 37), (115, 38), (115, 39), (115, 40), (115, 41), (115, 70), (115, 71), (115, 72), (115, 73), (115, 74), (115, 75), (115, 76), (115, 77), (115, 78), (116, 30), (116, 31), (116, 32), (116, 33), (116, 34), (116, 35), (116, 36), (116, 37), (116, 38), (116, 39), (116, 40), (116, 41), (116, 72), (116, 73), (116, 74), (116, 75), (116, 76), (116, 77), (117, 33), (117, 34), (117, 35), (117, 36), (117, 37), (117, 38), (117, 39), (117, 40), (117, 41), (117, 100), (117, 101), (117, 102), (117, 103), (118, 33), (118, 34), (118, 35), (118, 36), (118, 37), (118, 38), (118, 39), (118, 40), (118, 41), (118, 92), (118, 93), (118, 94), (118, 95), (118, 96), (118, 100), (118, 101), (118, 102), (118, 103), (118, 104), (119, 33), (119, 34), (119, 35), (119, 36), (119, 37), (119, 38), (119, 39), (119, 40), (119, 41), (119, 42), (119, 43), (119, 44), (119, 45), (119, 46), (119, 47), (119, 48), (119, 49), (119, 50), (119, 51), (119, 91), (119, 92), (119, 93), (119, 94), (119, 95), (119, 96), (119, 100), (119, 101), (119, 102), (119, 103), (119, 104), (120, 33), (120, 34), (120, 35), (120, 36), (120, 37), (120, 38), (120, 39), (120, 40), (120, 41), (120, 42), (120, 43), (120, 44), (120, 45), (120, 46), (120, 47), (120, 48), (120, 49), (120, 50), (120, 51), (120, 52), (120, 91), (120, 92), (120, 93), (120, 94), (120, 95), (120, 96), (120, 100), (120, 101), (120, 102), (120, 103), (120, 104), (121, 34), (121, 35), (121, 36), (121, 37), (121, 38), (121, 39), (121, 40), (121, 41), (121, 42), (121, 43), (121, 44), (121, 45), (121, 46), (121, 47), (121, 48), (121, 49), (121, 50), (121, 51), (121, 52), (121, 91), (121, 92), (121, 93), (121, 94), (121, 95), (121, 96), (121, 100), (121, 101), (121, 102), (121, 103), (121, 104), (122, 41), (122, 42), (122, 43), (122, 44), (122, 45), (122, 46), (122, 47), (122, 48), (122, 49), (122, 50), (122, 51), (122, 52), (122, 91), (122, 92), (122, 93), (122, 94), (122, 95), (122, 96), (122, 100), (122, 101), (122, 102), (122, 103), (122, 104), (122, 105), (122, 106), (122, 107), (122, 108), (122, 109), (123, 42), (123, 43), (123, 44), (123, 45), (123, 46), (123, 47), (123, 48), (123, 49), (123, 50), (123, 51), (123, 52), (123, 92), (123, 93), (123, 94), (123, 95), (123, 103), (123, 104), (123, 105), (123, 106), (123, 107), (123, 108), (123, 109), (124, 47), (124, 48), (124, 49), (124, 50), (124, 51), (124, 52), (124, 103), (124, 104), (124, 105), (124, 106), (124, 107), (124, 108), (124, 109), (124, 110), (125, 103), (125, 104), (125, 105), (125, 106), (125, 107), (125, 108), (125, 109), (125, 110), (126, 104), (126, 105), (126, 106), (126, 107), (126, 108), (126, 109), (126, 110), (127, 80), (127, 81), (127, 82), (127, 83), (127, 106), (127, 107), (127, 108), (127, 109), (127, 110), (127, 111), (128, 80), (128, 81), (128, 82), (128, 83), (128, 107), (128, 108), (128, 109), (128, 110), (128, 111), (128, 112), (129, 80), (129, 81), (129, 82), (129, 83), (129, 107), (129, 108), (129, 109), (129, 110), (129, 111), (129, 112), (130, 107), (130, 108), (130, 109), (130, 110), (130, 111), (130, 112), (131, 107), (131, 108), (131, 109), (131, 110), (131, 111), (131, 112), (132, 107), (132, 108), (132, 109), (132, 110), (132, 111), (133, 107), (133, 108), (133, 109), (133, 110), (133, 111), (134, 107), (134, 108), (134, 109), (134, 110), (154, 61), (154, 62), (154, 63), (155, 58), (155, 59), (155, 60), (155, 61), (155, 62), (155, 63), (155, 64), (156, 54), (156, 55), (156, 56), (156, 58), (156, 59), (156, 60), (156, 61), (156, 62), (156, 63), (156, 64), (156, 65), (156, 66), (157, 54), (157, 55), (157, 56), (157, 57), (157, 58), (157, 59), (157, 60), (157, 61), (157, 62), (157, 63), (157, 64), (157, 65), (157, 66), (158, 54), (158, 55), (158, 56), (158, 57), (158, 58), (158, 59), (158, 60), (158, 61), (158, 62), (158, 63), (158, 64), (158, 65), (158, 66), (158, 67), (159, 54), (159, 55), (159, 56), (159, 57), (159, 58), (159, 59), (159, 60), (159, 61), (159, 62), (159, 63), (159, 64), (159, 65), (159, 66), (159, 67), (160, 54), (160, 55), (160, 56), (160, 57), (160, 59), (160, 60), (160, 61), (160, 64), (160, 65), (160, 66), (160, 67), (161, 65), (161, 66), (161, 67)]





filename = 'cat.jpg'
img = cv.imread(filename)
gray = cv.cvtColor(img,cv.COLOR_BGR2GRAY)
# print(len(key_points))
# print(gray.shape[0]*gray.shape[0])
# cv.imshow("gray",gray)
# cv.waitKey(0)
new_key_points = main_orientation(gray,key_points)
new_key_points = local_descriptors(gray,new_key_points)
result1 = np.array(new_key_points)
# print(result1[0].shape)
# print(type(result1[0]))
image2 = cv.imread("cat22.jpg", cv.IMREAD_GRAYSCALE)
new_key_points2 = main_orientation(image2, key_points2)
new_key_points2 = local_descriptors(image2, new_key_points2)
result2 = np.array(new_key_points)
# print(result1.shape)
# print(result2.shape)
matches1 = []
matches2 = []
for idx, ele2  in enumerate(result2):
    points_dis = []
    for ele1 in result1:
        diff = ele1[3]-ele2[3]
        ssd = np.sum(np.square(diff))
        points_dis.append(ssd)
    # index = np.unravel_index(np.argmin(points_dis), len(points_dis))
    index = points_dis.index(min(points_dis))
    coordinates = (result1[index][0], result1[index][1])
    matches1.append(coordinates)
    matches2.append(result2[idx])
# result_image = img
# for match in matches1:
#     result_image = cv.circle(result_image, (match[0], match[1]), radius=0, color=(0, 0, 255), thickness=-1)
# cv.imshow("result", result_image)
# cv.waitKey(0)


fig = plt.figure(figsize=(10,5))
ax1 = fig.add_subplot(121)
ax2 = fig.add_subplot(122)

ax1.imshow(gray)
ax2.imshow(image2)


for i in range(0, len(matches1), 15):
    con = ConnectionPatch(xyA=(matches1[i][0], matches1[i][1]), xyB=(matches2[i][0], matches2[i][1]), coordsA="data", coordsB="data",
                        axesA=ax1, axesB=ax2, color="red")
    ax2.add_artist(con)
    # print("hello")
plt.show()



img = cv.imread(filename)
gray = cv.cvtColor(img,cv.COLOR_BGR2GRAY)
# gray = np.float32(gray)
# dst = cv.cornerHarris(gray,2,3,0.04)
# temp=np.zeros(gray.shape)
# #result is dilated for marking the corners, not important
# dst = cv.dilate(dst,None)
# # Threshold for an optimal value, it may vary depending on the image.
# img[dst>0.01*dst.max()]=[0,255,0]
# cv.imshow('dst',img)
# if cv.waitKey(0) & 0xff == 27:
    # cv.destroyAllWindows()

key_points=[
    (3, 64), (3, 65), (3, 66), (4, 64), (4, 65), (4, 66), (4, 67), (5, 64), (5, 65), (5, 66), (5, 67), (6, 64), (6, 65), (6, 66), (6, 67), (8, 59), (8, 60), (8, 61), (8, 62), (8, 63), (8, 64), (9, 59), (9, 60), (9, 61), (9, 62), (9, 63), (9, 64), (10, 59), (10, 60), (10, 61), (10, 62), (10, 63), (10, 64), (11, 59), (11, 60), (11, 61), (11, 62), (11, 63), (11, 64), (12, 59), (12, 60), (12, 61), (12, 62), (12, 63), (12, 64), (12, 65), (13, 59), (13, 60), (13, 61), (13, 62), (13, 63), (13, 64), (13, 65), (14, 59), (14, 60), (14, 61), (14, 62), (14, 63), (14, 64), (14, 65), (15, 60), (15, 61), (15, 62), (15, 63), (15, 64), (15, 65), (16, 60), (16, 61), (16, 62), (16, 63), (16, 64), (16, 65), (22, 57), (22, 58), (22, 59), (22, 60), (22, 61), (22, 62), (22, 214), (22, 215), (22, 216), (23, 57), (23, 58), (23, 59), (23, 60), (23, 61), (23, 62), (23, 214), (23, 215), (23, 216), (24, 57), (24, 58), (24, 59), (24, 60), (24, 61), (24, 62), (24, 63), (24, 214), (24, 215), (24, 216), (25, 60), (25, 61), (25, 62), (25, 63), (26, 60), (26, 61), (26, 62), (26, 63), (30, 57), (30, 58), (30, 59), (30, 60), (30, 61), (31, 57), (31, 58), (31, 59), (31, 60), (31, 61), (32, 57), (32, 58), (32, 59), (32, 60), (32, 61), (33, 57), (33, 58), (33, 59), (38, 99), (38, 100), (38, 101), (39, 99), (39, 100), (39, 101), (39, 102), (40, 99), (40, 100), (40, 101), (40, 102), (41, 100), (41, 101), (41, 102), (41, 107), (41, 108), (41, 109), (41, 110), (42, 107), (42, 108), (42, 109), (42, 110), (43, 107), (43, 108), (43, 109), (43, 110), (44, 107), (44, 108), (44, 109), (44, 110), (49, 110), (49, 111), (49, 112), (49, 113), (50, 101), (50, 102), (50, 103), (50, 110), (50, 111), (50, 112), (50, 113), (50, 114), (51, 101), (51, 102), (51, 103), (51, 104), (51, 110), (51, 111), (51, 112), (51, 113), (51, 114), (51, 164), (51, 165), (51, 166), (52, 101), (52, 102), (52, 103), (52, 104), (52, 107), (52, 108), (52, 109), (52, 110), (52, 111), (52, 112), (52, 113), (52, 114), (52, 162), (52, 163), (52, 164), (52, 165), (52, 166), (53, 101), (53, 102), (53, 103), (53, 104), (53, 107), (53, 108), (53, 109), (53, 110), (53, 111), (53, 112), (53, 113), (53, 114), (53, 162), (53, 163), (53, 164), (53, 165), (53, 166), (54, 102), (54, 103), (54, 104), (54, 107), (54, 108), (54, 109), (54, 110), (54, 111), (54, 112), (54, 113), (54, 114), (54, 115), (54, 117), (54, 118), (54, 119), (54, 162), (54, 163), (54, 164), (54, 165), (54, 166), (55, 107), (55, 108), (55, 109), (55, 110), (55, 111), (55, 112), (55, 113), (55, 114), (55, 115), (55, 117), (55, 118), (55, 119), (55, 162), (55, 163), (55, 164), (55, 165), (56, 107), (56, 108), (56, 109), (56, 110), (56, 111), (56, 112), (56, 113), (56, 114), (56, 115), (56, 117), (56, 118), (56, 119), (57, 108), (57, 109), (57, 110), (57, 111), (57, 112), (57, 113), (57, 114), (57, 115), (57, 117), (57, 118), (57, 119), (58, 105), (58, 106), (58, 107), (58, 108), (58, 109), (58, 110), (58, 111), (58, 112), (58, 113), (58, 114), (58, 115), (59, 105), (59, 106), (59, 107), (59, 108), (59, 109), (59, 110), (59, 111), (59, 112), (59, 113), (59, 114), (59, 115), (60, 105), (60, 106), (60, 107), (60, 108), (60, 109), (60, 110), (60, 111), (60, 112), (60, 113), (60, 114), (60, 115), (60, 154), (60, 155), (60, 156), (60, 157), (60, 158), (61, 105), (61, 106), (61, 107), (61, 108), (61, 109), (61, 110), (61, 111), (61, 112), (61, 113), (61, 114), (61, 154), (61, 155), (61, 156), (61, 157), (61, 158), (62, 105), (62, 106), (62, 107), (62, 108), (62, 109), (62, 110), (62, 111), (62, 112), (62, 113), (62, 114), (62, 115), (62, 153), (62, 154), (62, 155), (62, 156), (62, 157), (62, 158), (63, 106), (63, 107), (63, 108), (63, 109), (63, 110), (63, 111), (63, 112), (63, 113), (63, 114), (63, 115), (63, 153), (63, 154), (63, 155), (63, 156), (63, 157), (63, 158), (64, 107), (64, 108), (64, 109), (64, 110), (64, 111), (64, 112), (64, 113), (64, 114), (64, 115), (64, 153), (64, 154), (64, 155), (64, 156), (64, 157), (64, 158), (64, 159), (64, 160), (65, 108), (65, 109), (65, 110), (65, 111), (65, 112), (65, 113), (65, 114), (65, 153), (65, 154), (65, 155), (65, 156), (65, 157), (65, 158), (65, 159), (65, 160), (66, 109), (66, 110), (66, 111), (66, 112), (66, 117), (66, 118), (66, 119), (66, 156), (66, 157), (66, 158), (66, 159), (66, 160), (67, 117), (67, 118), (67, 119), (67, 120), (67, 156), (67, 157), (67, 158), (67, 159), (67, 160), (68, 92), (68, 93), (68, 94), (68, 117), (68, 118), (68, 119), (68, 120), (68, 156), (68, 157), (68, 158), (68, 159), (69, 92), (69, 93), (69, 94), (69, 95), (69, 117), (69, 118), (69, 119), (69, 120), (69, 156), (69, 157), (69, 158), (70, 92), (70, 93), (70, 94), (70, 95), (70, 117), (70, 118), (70, 119), (71, 93), (71, 94), (71, 95), (74, 147), (74, 148), (74, 149), (74, 150), (75, 147), (75, 148), (75, 149), (75, 150), (76, 122), (76, 123), (76, 124), (76, 147), (76, 148), (76, 149), (76, 150), (77, 122), (77, 123), (77, 124), (77, 125), (77, 147), (77, 148), (77, 149), (77, 150), (78, 114), (78, 115), (78, 116), (78, 117), (78, 118), (78, 119), (78, 122), (78, 123), (78, 124), (78, 125), (79, 114), (79, 115), (79, 116), (79, 117), (79, 118), (79, 119), (79, 122), (79, 123), (79, 124), (79, 125), (80, 114), (80, 115), (80, 116), (80, 117), (80, 118), (80, 119), (81, 114), (81, 115), (81, 116), (81, 117), (81, 118), (81, 119), (82, 200), (82, 201), (82, 202), (82, 203), (83, 199), (83, 200), (83, 201), (83, 202), (83, 203), (84, 108), (84, 109), (84, 110), (84, 111), (84, 112), (84, 115), (84, 116), (84, 117), (84, 199), (84, 200), (84, 201), (84, 202), (84, 203), (85, 108), (85, 109), (85, 110), (85, 111), (85, 112), (85, 114), (85, 115), (85, 116), (85, 117), (85, 199), (85, 200), (85, 201), (85, 202), (85, 203), (86, 108), (86, 109), (86, 110), (86, 111), (86, 112), (86, 114), (86, 115), (86, 116), (86, 117), (86, 155), (86, 156), (86, 157), (87, 99), (87, 100), (87, 101), (87, 108), (87, 109), (87, 110), (87, 111), (87, 112), (87, 114), (87, 115), (87, 116), (87, 117), (87, 118), (87, 139), (87, 140), (87, 141), (87, 142), (87, 154), (87, 155), (87, 156), (87, 157), (88, 98), (88, 99), (88, 100), (88, 101), (88, 102), (88, 108), (88, 109), (88, 110), (88, 111), (88, 112), (88, 115), (88, 116), (88, 117), (88, 118), (88, 119), (88, 138), (88, 139), (88, 140), (88, 141), (88, 142), (88, 154), (88, 155), (88, 156), (88, 157), (89, 98), (89, 99), (89, 100), (89, 101), (89, 102), (89, 103), (89, 104), (89, 108), (89, 109), (89, 110), (89, 111), (89, 112), (89, 115), (89, 116), (89, 117), (89, 118), (89, 119), (89, 138), (89, 139), (89, 140), (89, 141), (89, 142), (89, 143), (89, 154), (89, 155), (89, 156), (90, 98), (90, 99), (90, 100), (90, 101), (90, 102), (90, 103), (90, 104), (90, 105), (90, 106), (90, 109), (90, 110), (90, 111), (90, 115), (90, 116), (90, 117), (90, 118), (90, 119), (90, 138), (90, 139), (90, 140), (90, 141), (90, 142), (90, 143), (90, 144), (91, 98), (91, 99), (91, 100), (91, 101), (91, 102), (91, 103), (91, 104), (91, 105), (91, 106), (91, 107), (91, 116), (91, 117), (91, 118), (91, 119), (91, 138), (91, 139), (91, 140), (91, 141), (91, 142), (91, 143), (91, 144), (92, 99), (92, 100), (92, 101), (92, 102), (92, 103), (92, 104), (92, 105), (92, 106), (92, 107), (92, 116), (92, 117), (92, 118), (92, 119), (92, 138), (92, 139), (92, 140), (92, 141), (92, 142), (92, 143), (92, 144), (93, 87), (93, 88), (93, 89), (93, 90), (93, 91), (93, 99), (93, 100), (93, 101), (93, 102), (93, 103), (93, 104), (93, 105), (93, 106), (93, 107), (93, 117), (93, 118), (93, 119), (93, 138), (93, 139), (93, 140), (93, 141), (93, 142), (94, 87), (94, 88), (94, 89), (94, 90), (94, 91), (94, 100), (94, 101), (94, 102), (94, 103), (94, 104), (94, 105), (94, 106), (94, 107), (94, 117), (94, 118), (94, 119), (94, 139), (94, 140), (94, 141), (95, 87), (95, 88), (95, 89), (95, 90), (95, 91), (95, 103), (95, 104), (95, 105), (95, 106), (95, 107), (95, 117), (95, 118), (95, 119), (95, 132), (95, 133), (95, 134), (95, 135), (95, 136), (95, 142), (95, 143), (95, 144), (95, 145), (96, 87), (96, 88), (96, 89), (96, 90), (96, 91), (96, 104), (96, 105), (96, 106), (96, 116), (96, 117), (96, 118), (96, 119), (96, 131), (96, 132), (96, 133), (96, 134), (96, 135), (96, 136), (96, 137), (96, 142), (96, 143), (96, 144), (96, 145), (96, 146), (97, 88), (97, 89), (97, 90), (97, 116), (97, 117), (97, 118), (97, 119), (97, 127), (97, 128), (97, 129), (97, 131), (97, 132), (97, 133), (97, 134), (97, 135), (97, 136), (97, 137), (97, 141), (97, 142), (97, 143), (97, 144), (97, 145), (97, 146), (97, 147), (98, 102), (98, 103), (98, 104), (98, 105), (98, 113), (98, 114), (98, 115), (98, 116), (98, 117), (98, 118), (98, 119), (98, 127), (98, 128), (98, 129), (98, 131), (98, 132), (98, 133), (98, 134), (98, 135), (98, 136), (98, 137), (98, 138), (98, 139), (98, 140), (98, 141), (98, 142), (98, 143), (98, 144), (98, 145), (98, 146), (98, 147), (99, 102), (99, 103), (99, 104), (99, 105), (99, 106), (99, 112), (99, 113), (99, 114), (99, 115), (99, 116), (99, 117), (99, 118), (99, 119), (99, 125), (99, 126), (99, 127), (99, 128), (99, 129), (99, 131), (99, 132), (99, 133), (99, 134), (99, 135), (99, 136), (99, 137), (99, 138), (99, 139), (99, 140), (99, 141), (99, 142), (99, 143), (99, 144), (99, 145), (99, 146), (99, 147), (100, 100), (100, 101), (100, 102), (100, 103), (100, 104), (100, 105), (100, 106), (100, 111), (100, 112), (100, 113), (100, 114), (100, 115), (100, 116), (100, 117), (100, 118), (100, 119), (100, 125), (100, 126), (100, 127), (100, 128), (100, 129), (100, 130), (100, 131), (100, 132), (100, 133), (100, 134), (100, 137), (100, 138), (100, 139), (100, 140), (100, 141), (100, 142), (100, 143), (100, 144), (100, 145), (100, 146), (100, 147), (101, 100), (101, 101), (101, 102), (101, 103), (101, 104), (101, 105), (101, 106), (101, 107), (101, 108), (101, 110), (101, 111), (101, 112), (101, 113), (101, 114), (101, 115), (101, 116), (101, 117), (101, 118), (101, 125), (101, 126), (101, 127), (101, 128), (101, 129), (101, 130), (101, 131), (101, 132), (101, 141), (101, 142), (101, 143), (101, 144), (101, 145), (101, 146), (101, 147), (101, 148), (101, 149), (102, 99), (102, 100), (102, 101), (102, 102), (102, 103), (102, 104), (102, 105), (102, 106), (102, 107), (102, 108), (102, 110), (102, 111), (102, 112), (102, 113), (102, 114), (102, 115), (102, 116), (102, 117), (102, 125), (102, 126), (102, 127), (102, 128), (102, 129), (102, 130), (102, 131), (102, 132), (102, 143), (102, 144), (102, 145), (102, 146), (102, 147), (102, 148), (102, 149), (103, 94), (103, 95), (103, 96), (103, 97), (103, 98), (103, 99), (103, 100), (103, 101), (103, 102), (103, 103), (103, 104), (103, 105), (103, 106), (103, 107), (103, 108), (103, 110), (103, 111), (103, 112), (103, 113), (103, 114), (103, 115), (103, 116), (103, 117), (103, 130), (103, 131), (103, 132), (103, 143), (103, 144), (103, 145), (103, 146), (103, 147), (103, 148), (103, 149), (104, 72), (104, 73), (104, 74), (104, 75), (104, 76), (104, 77), (104, 94), (104, 95), (104, 96), (104, 97), (104, 98), (104, 99), (104, 100), (104, 101), (104, 102), (104, 103), (104, 104), (104, 105), (104, 106), (104, 107), (104, 108), (104, 110), (104, 111), (104, 112), (104, 113), (104, 114), (104, 115), (104, 116), (104, 117), (104, 143), (104, 144), (104, 145), (104, 146), (104, 147), (104, 148), (104, 149), (105, 72), (105, 73), (105, 74), (105, 75), (105, 76), (105, 77), (105, 78), (105, 81), (105, 82), (105, 83), (105, 84), (105, 94), (105, 95), (105, 96), (105, 97), (105, 98), (105, 99), (105, 100), (105, 101), (105, 119), (105, 120), (105, 121), (105, 144), (105, 145), (105, 146), (105, 147), (105, 148), (105, 149), (106, 70), (106, 71), (106, 72), (106, 73), (106, 74), (106, 75), (106, 76), (106, 77), (106, 78), (106, 79), (106, 80), (106, 81), (106, 82), (106, 83), (106, 84), (106, 85), (106, 86), (106, 95), (106, 96), (106, 97), (106, 98), (106, 99), (106, 100), (106, 101), (106, 119), (106, 120), (106, 121), (106, 143), (106, 144), (106, 145), (106, 146), (107, 69), (107, 70), (107, 71), (107, 72), (107, 73), (107, 74), (107, 75), (107, 76), (107, 77), (107, 78), (107, 79), (107, 80), (107, 81), (107, 82), (107, 83), (107, 84), (107, 85), (107, 86), (107, 98), (107, 99), (107, 100), (107, 101), (107, 119), (107, 120), (107, 121), (107, 143), (107, 144), (107, 145), (107, 146), (108, 69), (108, 70), (108, 71), (108, 72), (108, 73), (108, 74), (108, 77), (108, 78), (108, 79), (108, 80), (108, 81), (108, 82), (108, 83), (108, 84), (108, 85), (108, 86), (108, 91), (108, 92), (108, 93), (108, 98), (108, 99), (108, 100), (108, 101), (108, 102), (108, 141), (108, 142), (108, 143), (108, 144), (108, 145), (108, 146), (109, 69), (109, 70), (109, 71), (109, 72), (109, 73), (109, 74), (109, 77), (109, 78), (109, 79), (109, 80), (109, 81), (109, 82), (109, 83), (109, 84), (109, 85), (109, 86), (109, 91), (109, 92), (109, 93), (109, 98), (109, 99), (109, 100), (109, 101), (109, 102), (109, 139), (109, 140), (109, 141), (109, 142), (109, 143), (109, 144), (109, 145), (109, 146), (109, 147), (109, 148), (109, 149), (109, 150), (109, 151), (109, 152), (110, 69), (110, 70), (110, 71), (110, 72), (110, 73), (110, 77), (110, 78), (110, 79), (110, 80), (110, 81), (110, 82), (110, 83), (110, 84), (110, 85), (110, 91), (110, 92), (110, 93), (110, 100), (110, 101), (110, 102), (110, 139), (110, 140), (110, 141), (110, 142), (110, 143), (110, 144), (110, 145), (110, 146), (110, 147), (110, 148), (110, 149), (110, 150), (110, 151), (110, 152), (111, 69), (111, 70), (111, 71), (111, 72), (111, 77), (111, 78), (111, 79), (111, 80), (111, 81), (111, 82), (111, 83), (111, 84), (111, 91), (111, 92), (111, 93), (111, 139), (111, 140), (111, 141), (111, 142), (111, 143), (111, 144), (111, 145), (111, 146), (111, 147), (111, 148), (111, 149), (111, 150), (111, 151), (111, 152), (112, 77), (112, 78), (112, 79), (112, 80), (112, 81), (112, 82), (112, 83), (112, 140), (112, 141), (112, 142), (112, 143), (112, 144), (112, 145), (112, 146), (112, 147), (112, 148), (112, 149), (112, 150), (112, 151), (113, 77), (113, 78), (113, 79), (113, 80), (113, 81), (113, 82), (113, 83), (113, 87), (113, 88), (113, 89), (113, 90), (113, 142), (113, 143), (113, 144), (113, 145), (113, 146), (113, 147), (114, 77), (114, 78), (114, 79), (114, 80), (114, 81), (114, 87), (114, 88), (114, 89), (114, 90), (114, 142), (114, 143), (114, 144), (114, 145), (114, 146), (114, 147), (115, 78), (115, 79), (115, 80), (115, 86), (115, 87), (115, 88), (115, 89), (115, 90), (115, 142), (115, 143), (115, 144), (115, 145), (115, 146), (115, 167), (115, 168), (115, 169), (115, 170), (115, 171), (115, 172), (116, 86), (116, 87), (116, 88), (116, 89), (116, 90), (116, 99), (116, 100), (116, 101), (116, 142), (116, 143), (116, 144), (116, 161), (116, 162), (116, 163), (116, 164), (116, 165), (116, 166), (116, 167), (116, 168), (116, 169), (116, 170), (116, 171), (116, 172), (116, 173), (116, 174), (116, 175), (116, 176), (117, 86), (117, 87), (117, 88), (117, 89), (117, 90), (117, 99), (117, 100), (117, 101), (117, 102), (117, 161), (117, 162), (117, 163), (117, 164), (117, 165), (117, 166), (117, 167), (117, 168), (117, 169), (117, 170), (117, 171), (117, 172), (117, 173), (117, 174), (117, 175), (117, 176), (117, 177), (117, 178), (118, 87), (118, 88), (118, 89), (118, 90), (118, 99), (118, 100), (118, 101), (118, 102), (118, 161), (118, 162), (118, 163), (118, 164), (118, 165), (118, 166), (118, 167), (118, 168), (118, 169), (118, 170), (118, 171), (118, 172), (118, 173), (118, 174), (118, 175), (118, 176), (118, 177), (118, 178), (119, 99), (119, 100), (119, 101), (119, 102), (119, 161), (119, 162), (119, 163), (119, 164), (119, 165), (119, 166), (119, 167), (119, 168), (119, 169), (119, 170), (119, 171), (119, 172), (119, 173), (119, 174), (119, 175), (119, 176), (119, 177), (119, 178), (120, 99), (120, 100), (120, 101), (120, 162), (120, 163), (120, 164), (120, 165), (120, 167), (120, 168), (120, 169), (120, 170), (120, 173), (120, 174), (120, 175), (120, 176), (120, 177), (120, 178), (121, 99), (121, 100), (121, 101), (121, 156), (121, 157), (121, 158), (121, 159), (121, 174), (121, 175), (121, 176), (121, 177), (121, 178), (122, 99), (122, 100), (122, 101), (122, 156), (122, 157), (122, 158), (122, 159), (122, 160), (122, 174), (122, 175), (122, 176), (122, 177), (122, 178), (123, 156), (123, 157), (123, 158), (123, 159), (123, 160), (123, 175), (123, 176), (123, 177), (123, 178), (124, 99), (124, 100), (124, 101), (124, 156), (124, 157), (124, 158), (124, 159), (124, 160), (125, 99), (125, 100), (125, 101), (125, 102), (125, 156), (125, 157), (125, 158), (125, 159), (125, 160), (126, 99), (126, 100), (126, 101), (126, 102), (126, 156), (126, 157), (126, 158), (126, 159), (126, 160), (127, 95), (127, 96), (127, 97), (127, 99), (127, 100), (127, 101), (127, 102), (128, 92), (128, 93), (128, 94), (128, 95), (128, 96), (128, 97), (128, 98), (128, 99), (128, 100), (128, 101), (128, 102), (128, 140), (128, 141), (128, 142), (129, 89), (129, 90), (129, 91), (129, 92), (129, 93), (129, 94), (129, 95), (129, 96), (129, 97), (129, 98), (129, 139), (129, 140), (129, 141), (129, 142), (130, 88), (130, 89), (130, 90), (130, 91), (130, 92), (130, 93), (130, 94), (130, 95), (130, 96), (130, 97), (130, 98), (130, 138), (130, 139), (130, 140), (130, 141), (130, 142), (131, 88), (131, 89), (131, 90), (131, 91), (131, 92), (131, 93), (131, 94), (131, 95), (131, 96), (131, 97), (131, 98), (131, 99), (131, 100), (131, 137), (131, 138), (131, 139), (131, 140), (131, 141), (131, 142), (132, 88), (132, 89), (132, 90), (132, 91), (132, 92), (132, 93), (132, 94), (132, 95), (132, 98), (132, 99), (132, 100), (132, 136), (132, 137), (132, 138), (132, 139), (132, 140), (132, 141), (132, 142), (133, 94), (133, 95), (133, 96), (133, 97), (133, 98), (133, 99), (133, 100), (133, 135), (133, 136), (133, 137), (133, 138), (133, 139), (133, 140), (133, 141), (133, 142), (134, 91), (134, 92), (134, 93), (134, 94), (134, 95), (134, 96), (134, 97), (134, 135), (134, 136), (134, 137), (134, 138), (134, 139), (134, 140), (134, 141), (134, 142), (135, 89), (135, 90), (135, 91), (135, 92), (135, 93), (135, 94), (135, 95), (135, 96), (135, 97), (135, 135), (135, 136), (135, 137), (135, 138), (135, 139), (135, 140), (135, 141), (135, 142), (136, 89), (136, 90), (136, 91), (136, 92), (136, 93), (136, 94), (136, 95), (136, 96), (136, 135), (136, 136), (136, 137), (136, 138), (136, 139), (136, 185), (136, 186), (136, 187), (136, 188), (137, 89), (137, 90), (137, 91), (137, 92), (137, 93), (137, 94), (137, 95), (137, 96), (137, 185), (137, 186), (137, 187), (137, 188), (138, 89), (138, 90), (138, 91), (138, 92), (138, 93), (138, 94), (138, 95), (138, 96), (138, 185), (138, 186), (138, 187), (138, 188), (139, 92), (139, 93), (139, 94), (139, 95), (150, 98), (150, 99), (150, 100), (150, 101), (151, 97), (151, 98), (151, 99), (151, 100), (151, 101), (151, 102), (152, 97), (152, 98), (152, 99), (152, 100), (152, 101), (152, 102), (152, 103), (153, 97), (153, 98), (153, 99), (153, 100), (153, 101), (153, 102), (153, 103), (153, 125), (153, 126), (153, 127), (153, 128), (153, 129), (154, 97), (154, 98), (154, 99), (154, 100), (154, 101), (154, 102), (154, 103), (154, 125), (154, 126), (154, 127), (154, 128), (154, 129), (154, 130), (155, 98), (155, 99), (155, 100), (155, 101), (155, 102), (155, 103), (155, 125), (155, 126), (155, 127), (155, 128), (155, 129), (155, 130), (156, 99), (156, 100), (156, 101), (156, 102), (156, 103), (156, 104), (156, 107), (156, 108), (156, 109), (156, 124), (156, 125), (156, 126), (156, 127), (156, 128), (156, 129), (156, 130), (157, 99), (157, 100), (157, 101), (157, 102), (157, 103), (157, 104), (157, 105), (157, 106), (157, 107), (157, 108), (157, 109), (157, 110), (157, 122), (157, 123), (157, 124), (157, 125), (157, 126), (157, 127), (157, 128), (157, 129), (157, 130), (158, 100), (158, 101), (158, 102), (158, 103), (158, 104), (158, 105), (158, 106), (158, 107), (158, 108), (158, 109), (158, 110), (158, 115), (158, 116), (158, 117), (158, 118), (158, 119), (158, 121), (158, 122), (158, 123), (158, 124), (158, 125), (158, 126), (158, 127), (158, 128), (158, 129), (158, 130), (159, 102), (159, 103), (159, 104), (159, 105), (159, 106), (159, 107), (159, 108), (159, 109), (159, 110), (159, 111), (159, 112), (159, 113), (159, 115), (159, 116), (159, 117), (159, 118), (159, 119), (159, 120), (159, 121), (159, 122), (159, 123), (159, 124), (159, 125), (159, 126), (159, 127), (159, 128), (160, 104), (160, 105), (160, 106), (160, 107), (160, 108), (160, 109), (160, 110), (160, 111), (160, 112), (160, 113), (160, 115), (160, 116), (160, 117), (160, 118), (160, 119), (160, 120), (160, 121), (160, 122), (160, 123), (160, 124), (160, 125), (160, 126), (161, 104), (161, 105), (161, 106), (161, 107), (161, 108), (161, 109), (161, 110), (161, 111), (161, 112), (161, 113), (161, 114), (161, 115), (161, 116), (161, 117), (161, 118), (161, 119), (161, 120), (161, 121), (161, 122), (161, 123), (161, 124), (161, 125), (162, 104), (162, 105), (162, 106), (162, 107), (162, 108), (162, 109), (162, 110), (162, 111), (162, 112), (162, 113), (162, 114), (162, 115), (162, 116), (162, 117), (162, 118), (162, 119), (162, 120), (163, 104), (163, 105), (163, 106), (163, 107), (163, 108), (163, 109), (163, 110), (163, 111), (163, 112), (163, 113), (163, 114), (163, 115), (163, 116), (163, 117), (163, 118), (163, 119), (163, 120), (164, 106), (164, 107), (164, 108), (164, 109), (164, 110), (164, 111), (164, 112), (164, 113), (164, 114), (164, 115), (164, 116), (164, 117), (164, 118), (164, 119), (165, 107), (165, 108), (165, 109), (165, 110), (165, 111), (165, 113), (165, 114), (165, 115), (165, 116), (165, 117), (166, 113), (166, 114), (166, 115), (166, 116), (166, 117), (169, 161), (169, 162), (169, 163), (169, 164), (169, 165), (170, 159), (170, 160), (170, 161), (170, 162), (170, 163), (170, 164), (170, 165), (170, 166), (170, 167), (171, 159), (171, 160), (171, 161), (171, 162), (171, 163), (171, 164), (171, 165), (171, 166), (171, 167), (172, 158), (172, 159), (172, 160), (172, 161), (172, 162), (172, 163), (172, 164), (172, 165), (172, 166), (172, 167), (173, 158), (173, 159), (173, 160), (173, 161), (173, 162), (173, 163), (174, 158), (174, 159), (174, 160), (174, 161), (174, 162), (175, 158), (175, 159), (175, 160), (175, 161), (175, 162), (176, 155), (176, 156), (176, 157), (176, 158), (176, 159), (176, 160), (176, 161), (176, 162), (177, 155), (177, 156), (177, 157), (177, 158), (177, 159), (178, 155), (178, 156), (178, 157), (178, 158), (178, 159), (179, 156), (179, 157), (179, 158), (179, 159)]
# new_key_points=main_orientation(gray,key_points)
# new_key_points=local_descriptors(gray,new_key_points)
# print(np.array(key_points).shape)
# print(np.array(new_key_points).shape)
